<h1>Saved Items</h1>

    <script>
        var html = "<div>";
    </script>
    <%@products = Product.all%>
    <div class="grid-container">
    <%@products.each do |product|%>
        <div class="grid-item" id = "products">
        <script>
            var array = new Array();
            for (let i = 0; i < localStorage.length; i++){
            array[i] = localStorage.getItem(localStorage.key(i));
            };
            // var html = "<div>";
            for (var i = 0; i < array.length; i++) 
            {
                if(<%=product.id%> == array[i])
                {
                    window.html += '<div class="card">' + '<img src=<%=product.imageSource%> alt ="" class="center" width="300" height= "300" >' + 
                    '<div class="center">' + '<h2><%=product.name%></h2>' + '<p class="price">$<%=product.price%></p>' + '<p><%=product.description%></p>'+ 
                    '<input id=<%= product.id%> type="button" onclick="myFunction(<%=product.id%>, this);" value = "Saved" style= "color: blue"/>'  + '</div>' + '</div>';
                }
            }
            window.html += "</div>";
            document.getElementById("products").innerHTML = window.html;
        </script>
    </div>
    </div>
    <%end%>


<script>
      function myFunction(x, elmnt){
      if (localStorage.getItem(x) !== null){
      alert("Removing product " + x + " from saved list");
      localStorage.removeItem(JSON.stringify(x));
      elmnt.value = '+';
      elmnt.style.color = 'black';
    }
    else{
      alert("Product saved with id " + x);
      localStorage.setItem(JSON.stringify(x), JSON.stringify(x));
      elmnt.value = 'Saved';
      elmnt.style.color = 'blue';
    }
    }; 
</script>